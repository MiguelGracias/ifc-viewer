<script type="module">
  import * as OBC from "https://cdn.jsdelivr.net/npm/@thatopen/components@latest/dist/index.js";

  const container = document.getElementById("viewer-container");
  const dropHint = document.getElementById("drop-hint");

  const components = new OBC.Components();
  components.add(OBC.Camera);
  components.add(OBC.Scene);
  components.add(OBC.Renderer);
  components.add(OBC.SimpleGrid);
  components.add(OBC.AxesHelper);
  components.add(OBC.Postproduction);

  const viewer = new OBC.Viewer(container);
  viewer.setComponents(components);

  components.add(OBC.IfcLoader);
  const ifcLoader = components.get(OBC.IfcLoader);

  container.addEventListener("dragover", (event) => {
    event.preventDefault();
    dropHint.style.opacity = 1;
    event.dataTransfer.dropEffect = "copy";
  });

  container.addEventListener("dragleave", () => {
    dropHint.style.opacity = 0.6;
  });

  container.addEventListener("drop", async (event) => {
    event.preventDefault();
    dropHint.style.display = "none";
    const file = event.dataTransfer.files[0];
    if (file && file.name.endsWith(".ifc")) {
      const url = URL.createObjectURL(file);
      await ifcLoader.load(url);
    }
  });
</script>

